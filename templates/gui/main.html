{% extends 'base.html' %}
{% load i18n thumbnail images_extras %}
{% block extrastyle %}
<link rel="stylesheet" href="/s/fancybox/jquery.fancybox-1.3.1.css" type="text/css" media="screen" title="no title" charset="utf-8">
{% endblock %}
{% block extrahead %}
<script src="/s/fancybox/jquery.fancybox-1.3.1.pack.js" type="text/javascript" charset="utf-8"></script>
<script src="/s/fancybox/jquery.easing-1.3.pack.js" type="text/javascript" charset="utf-8"></script>
<script src="/s/fancybox/jquery.mousewheel-3.0.2.pack.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" charset="utf-8">
	function r(){
		// 
		 $('div#cart').hide().load('{% url show_cart %}').show('fast');
	}	
		
	function menu(el, s){
		// open or close menu items
		if ($('div#' + el + '_' + s).length == 0){
			$('<div/>').attr({'id': el + '_' + s}).appendTo($('div#' + el)).load('/menu/' + s + '/');			
		}else{
			$('div#' + el + '_' + s).detach();
		}

	}
	
	
		
	$(function(){
		r();
		$('div#menuContent').load('/menu/_ALL_');
		$("a.group").fancybox({
				'transitionIn'	:	'elastic',
				'transitionOut'	:	'elastic',
				'speedIn'		:	600, 
				'speedOut'		:	200, 
				'overlayShow'	:	true
			});
		$("a.iframe").fancybox({
				'transitionIn'	:	'elastic',
				'transitionOut'	:	'elastic',
				'speedIn'		:	600, 
				'speedOut'		:	200, 
				'width'			:   842,
				'height'		:   '85%',
				'overlayShow'	:	true
			});
		
		
		$('a.iframe').bind("mouseover", function(){
			$('div#metadata')
							.show()
							.load('/interface/show/description/' + $(this).attr('id') + "/0/")
							.css({'top': ($(this).offset().top+16) + 'px', 'left': $(this).offset().left + 'px'});
		});
		$('a.iframe').bind("mouseout", function(){$('div#metadata').hide()});
		
	});
</script>
{% endblock %}

{% block content %}

{% include 'includes/menu-include.html' %}

<div class="main">
	<div class="nav">  
		<div id="searchform">		
			<form id="search" method="get" action="/search">
		       <input type="text" name="q" id="id_q" />
		    	<input id="form_search" type="submit" value="{% trans 'Search' %}">
		  	</form>
		</div>			
	
		{% if page.has_previous or page.has_next %}
	      <div class="pager">
			  <div>{{page.count}} {% trans "results" %}</div>
	              {% if page.has_previous %}<a href="/{{url}}{{ page.previous_page_number }}">{% endif %}&laquo; Previous{% if page.has_previous %}</a>{% endif %}
	              |
	              {% if page.has_next %}<a href="/{{url}}{{ page.next_page_number }}">{% endif %}Next &raquo;{% if page.has_next %}</a>{% endif %}
	      </div>
		{% endif %}
	</div> <!-- end nav -->
	<div class="divider"></div>
	<div id="results">        
		{% for result in page.object_list %}
	            <div class="item">
					<div class="header">
						{% if result.copyright %}
						<img src="/s/_img_interface/copyright-yes.png" width="10" height="10" alt="Copyright Yes">
						{% else %}
						<img src="/s/_img_interface/copyright-no.png" width="10" height="10" alt="Copyright No">
						{% endif %}
						{% if result.document %}
						<img title="{% trans 'this item contains an attachment'%}" style="cursor: help" border="0" src="/s/_img_interface/attachment.png" width="10" height="10" alt="Attachment">
						{% endif %}
					</div>
					<div class="image">      
						<a class="group" rel="main" href="/gallery/images/{{result.image_LNID}}.jpg">
							
							{% thumbnail result.image.get_image 148x148 crop upscale as image %}
							<img class="item-image"  src="{{image}}" border="0" width="{{image.width}}" height="{{image.width}}" alt="{{result.subject|truncate:100}}" />
						</a>
					</div>						
					<div class="label"></div>
					<div class="data">	
						{{result.title}}{{result.keywords}}		
					</div>
					<div class="item-nav">
						<a id="{{result.image_LNID}}" title="{% if result.subject %}{{result.subject}}{% else %} {{result.keywords|truncatewords:10}}{% endif %}" class="iframe detail" href="/interface/show/description/{{result.image_LNID}}/1/">
							<img border="0" src="/s/_img_interface/detail/15px.png" width="15" height="15" alt="{{result.subject}}">
						</a>
						<a class="add-to-cart" title="{% trans 'add to cart' %}" href="#" onclick="$.get('{% url add_item result.image_LNID %}');r();">
							<img src="/s/_img_interface/cart-grey/15px.png" width="15" height="15" alt="{% trans 'add to cart' %}" border="0" />
						</a>							
					</div>
	            </div>
	        {% empty %}
	            <p>{% trans "No results found" %}.</p>
				{% if sqs %}
				{% ifnotequal partition|length 1 %}
				<p>{% trans "You may also try the spelling suggestions as seperate words:"%} | {% for item in partition %}<a href="/search/?q={{item}}">{{item}}</a> | {% endfor %}</p>
				{% endifnotequal %}
				{% endif %}
	        {% endfor %}
	</div>
	{% include 'includes/cart-include.html' %}
</div>
{% endblock %}